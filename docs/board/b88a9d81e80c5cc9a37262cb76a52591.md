---
id: b88a9d81e80c5cc9a37262cb76a52591
title:  Kaseya VSA 远程代码执行漏洞通告
tags: 
  - 安全资讯
  - 360CERT
---

#  Kaseya VSA 远程代码执行漏洞通告

 0x01   漏洞简述
------------


2021年07月06日，360CERT监测发现`Kaseya`发布了`VSA管理软件`的风险通告，漏洞等级：`严重`，漏洞评分：`9.8`。

Kaseya VSA是一款企业用于集中IT管理的软件。分为管理端和用户端，管理端可以批量的控制用户端设备，例如在用户端设备上执行命令、执行脚本、开启/关闭电源等。

根据其官方通告以及监测到的REvil利用VSA漏洞的勒索事件，VSA软件中存在多个严重漏洞。攻击者可以利用这些漏洞绕过身份验证直接控制VSA管理端，并可通过管理端进一步控制其下属设备。

对此，360CERT建议广大用户好资产自查以及预防工作，以免遭受黑客攻击。

 0x02   风险等级
------------

360CERT对该漏洞的评定结果如下



| 评定方式 | 等级 |
| --- | --- |
| 威胁等级 | 严重 |
| 影响面 | 广泛 |
| 攻击者价值 | 极高 |
| 利用难度 | 低 |
| 360CERT评分 | 9.8 |

 0x03   漏洞详情
------------

### CVE-2021-30116: VSA SQL注入漏洞

CVE: CVE-2021-30116

组件: VSA

漏洞类型: SQL注入；代码执行

影响: 服务器接管

简述: VSA管理程序Endpoint中存在多处SQL注入漏洞，该漏洞位于`userFilterTableRpt.asp`，通过相连接的SQL Server攻击者可以通过执行恶意查询语句，借此执行系统命令以及 .net 代码。

### CVE-2021-30116: VSA 身份验证绕过漏洞

CVE: CVE-2021-30116

组件: VSA

漏洞类型: 代码执行

影响: 绕过身份验证限制使用服务所提供功能；服务器接管

简述: VSA管理程序的Endpoint中存在一处身份验证绕过漏洞，该漏洞位于`dl.asp`路由，并可以与该路由下的其他路径功能相组合使用。

### CVE-2021-30116: VSA 文件上传漏洞

CVE: CVE-2021-30116

组件: VSA

漏洞类型: 文件上传

影响: 上传恶意文件至服务器；服务器接管

简述: VSA管理程序的Endpoint中存在一处任意文件上传漏洞，该漏洞位于`KUpload.dll`， 该上传漏洞的成因是正常的上传功能与身份验证漏洞的结合，导致攻击者可以借此攻陷系统。

 0x04   影响版本
------------



| 组件 | 影响版本 | 安全版本 |
| --- | --- | --- |
| Kaseya:VSA | * | 暂无 |

 0x05   修复建议
------------

### 通用修补建议

暂无

### 临时修补建议

Kaseya官方建议用户在发布更新修复程序之前按照以下步骤进行处置

- 断开本地VSA服务器的网络连接，并保持设备的离线

- 使用官方提供的检测脚本，针对VSA受控的下属设备进行检测

[Kaseya 官方检测程序下载](https://kaseya.app.box.com/s/0ysvgss7w48nxh8k1xt7fqhbcjxhas40)