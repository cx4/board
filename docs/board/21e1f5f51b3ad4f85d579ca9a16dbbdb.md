---
id: 21e1f5f51b3ad4f85d579ca9a16dbbdb
title: ntopng 权限绕过与任意代码执行漏洞通告
tags: 
  - 安全资讯
  - 360CERT
---

# ntopng 权限绕过与任意代码执行漏洞通告

0x01漏洞简述
--------


2021年03月23日，360NoahLab发布了关于`ntopng`的风险通告，漏洞编号为`CVE-2021-28073/CVE-2021-28074`，漏洞等级：`高危`，漏洞评分：`8.0`。

ntopng 是一套开源的网络流量监控工具，提供基于 Web 界面的实时网络流量监控。支持跨平台，包括 Windows、Linux 以及 MacOS。ntopng 使用 C++ 语言开发，其绝大部分 Web 逻辑使用 lua 开发。

同时 ntopng 被部分路由器或者网络设备作为底层组件用于监控和梳理所在环境的网络流程情况。建议用户结合自身情况进行检查和修复。

**ntopng官方已于2021年03月05日发布修复代码于 github 仓库**

对此，360CERT建议广大用户及时将`ntopng`升级到最新版本。与此同时，请做好资产自查以及预防工作，以免遭受黑客攻击。

0x02风险等级
--------

360CERT对该漏洞的评定结果如下



| 评定方式 | 等级 |
| --- | --- |
| 威胁等级 | 高危 |
| 影响面 | 一般 |
| 360CERT评分 | 8.0 |

0x03漏洞详情
--------

涉及漏洞CVE如下：

- CVE-2021-28073

- CVE-2021-28074

漏洞利用的核心在于对于 ntopng web 接口的权限认证绕过，导致攻击者可以在未授权的情况下请求复合漏洞利用条件的接口，并最终利用 ssrf 漏洞和高危服务实现代码执行。

0x04影响版本
--------

- `ntop:ntopng`: < commit e8b9721479f401f595c5c7bb151819aceb03ad71

0x05修复建议
--------

### 临时修补建议

ntopng 已经在 github 的 commit e8b9721479f401f595c5c7bb151819aceb03ad71 中修复了核心的权限绕过漏洞，但由于自行编译并应用到指定设备的实施难度较大。

360CERT建议：排查使用`ntopng`的服务，并将`ntopng`的相关端口禁止从互联网访问

0x06时间线
-------

**2021-03-24** 360NoahLab发布分析报告

**2021-03-24** 360CERT发布通告

0x07参考链接
--------

[1、 ntopng 流量分析工具多个漏洞分析](http://noahblog.360.cn/ntopng-multiple-vulnerabilities/)

[2、 Fixes string truncation possibly causing limited auth bypass](https://github.com/ntop/ntopng/commit/e8b9721479f401f595c5c7bb151819aceb03ad71)

0x08特制报告下载链接
------------

一直以来，360CERT对全球重要网络安全事件进行快速通报、应急响应。为更好地为政企用户提供最新漏洞以及信息安全事件的安全通告服务，现360CERT正式推出安全通告特制版报告，以便用户做资料留存、传阅研究与查询验证。 用户可直接通过以下链接进行特制报告的下载。

[ntopng 权限绕过与任意代码执行漏洞通告](http://pub-shbt.s3.360.cn/cert-public-file/【360CERT】ntopng_权限绕过与任意代码执行漏洞通告.pdf)若有订阅意向与定制需求请发送邮件至 g-cert-report#360.cn ，并附上您的 公司名、姓名、手机号、地区、邮箱地址。

