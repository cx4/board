---
id: 252b960f278622c2305371363a80a54e
title:  runc符号链接挂载与容器逃逸漏洞通告
tags: 
  - 安全资讯
  - 360CERT
---

#  runc符号链接挂载与容器逃逸漏洞通告

 0x01   漏洞简述
------------


2021年06月01日，360CERT监测发现`国外安全研究人员`发布了`runc符号链接挂载与容器逃逸漏洞`的POC，漏洞编号为`CVE-2021-30465`，漏洞等级：`高危`，漏洞评分：`7.6`。

runc是一个通用的标准化容器运行环境，其可以根据开放容器方案生成和运行容器。其被广泛的应用于各种虚拟化环境中，如Kubernets。成功利用该漏洞的攻击者可以突破虚拟化环境的限制，完成虚拟化逃逸，从对物理机进行攻击。

攻击者可以通过创建一个恶意的POD及container，将宿主机的目录挂载至container中，最终完成虚拟化逃逸。攻击复杂度较高，利用价值非常高。

对此，360CERT建议广大用户及时将`runc`升级到最新版本。与此同时，请做好资产自查以及预防工作，以免遭受黑客攻击。

 0x02   风险等级
------------

360CERT对该漏洞的评定结果如下



| 评定方式 | 等级 |
| --- | --- |
| 威胁等级 | 高危 |
| 影响面 | 广泛 |
| 攻击者价值 | 非常高 |
| 利用难度 | 较高 |
| 360CERT评分 | 7.6 |

 0x03   漏洞详情
------------

### CVE-2021-30465: runc符号链接挂载与容器逃逸

CVE: CVE-2021-30465

组件: runc

漏洞类型: 虚拟化逃逸

影响: 容器逃逸

简述: 当多个容器共享一个卷时，存在一个TOCTTOU（time-of-check-to-time-of-ues）缺陷，该缺陷可以被用于误导runc的挂载目标。攻击者可通过创建恶意POD及container，利用符号链接以及条件竞争漏洞，可挂载宿主机目录至 container 中，并最终可能导致容器逃逸。

 0x04   影响版本
------------

- `open containers:runc`: <=1.0.0-rc94

 0x05   修复建议
------------

### 通用修补建议

目前官方已发布针对该漏洞的补丁，建议用户将runc升级到1.0.0-rc95版本。

补丁链接如下：

https://github.com/opencontainers/runc/commit/0ca91f44f1664da834bc61115a849b56d22f595f

### 临时修补建议

推荐启用容器强化机制如LSM（APPArmor/SELinux），但该措施并不会完全阻止该攻击，只能限制攻击者造成的结果。

